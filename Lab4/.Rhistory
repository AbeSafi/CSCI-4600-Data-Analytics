### read in data
epi.data <- read.csv("epi_results_2024_pop_gdp_v2.csv", header=TRUE)
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(ggplot2)
### read in data
epi.data <- read.csv("epi_results_2024_pop_gdp_v2.csv", header=TRUE)
load("~/Classes/Semester7/DataAnalytics/Lab2/epi_results_2024_pop_gdp_v2.csv")
### read in data
epi.data <- read.csv("epi_results_2024_pop_gdp_v2.csv", header=TRUE)
### read in data
epi.data <- read.csv("epi_results_2024_pop_gdp_v2.csv", header=TRUE)
## load libraries
library(ggplot2)
library(ggfortify)
library(GGally)
library(e1071)
library(class)
library(psych)
library(readr)
library(caret)
## load libraries
library(ggplot2)
library(ggfortify)
library(GGally)
library(e1071)
library(class)
library(psych)
library(readr)
## set working directory so that files can be referenced without the full path
setwd("~/Courses/Data Analytics/Fall25/labs/lab 4/")
## read dataset
wine <- read_csv("wine.data", col_names = FALSE)
## read dataset
wine <- read_csv("wine.data", col_names = FALSE)
setwd("~/Classes/Semester7/DataAnalytics/Lab4")
## set working directory so that files can be referenced without the full path
setwd("~/Courses/Data Analytics/Fall25/labs/lab 4/")
## read dataset
wine <- read_csv("wine.data", col_names = FALSE)
## set column names
names(wine) <- c("Type","Alcohol","Malic acid","Ash","Alcalinity of ash","Magnesium","Total phenols","Flavanoids","Nonflavanoid Phenols","Proanthocyanins","Color Intensity","Hue","Od280/od315 of diluted wines","Proline")
library(readr)
## read dataset
wine <- read_csv("wine.data", col_names = FALSE)
## set column names
names(wine) <- c("Type","Alcohol","Malic acid","Ash","Alcalinity of ash","Magnesium","Total phenols","Flavanoids","Nonflavanoid Phenols","Proanthocyanins","Color Intensity","Hue","Od280/od315 of diluted wines","Proline")
## inspect data frame
head(wine)
wine$Type <- as.factor(wine$Type)
## visualize variables
pairs.panels(wine[,-1],gap = 0,bg = c("red", "yellow", "blue")[wine$Type],pch=21)
ggpairs(wine, ggplot2::aes(colour = Type))
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Plot using 1st and 2nd PCs
autoplot(pca_result, data = wine, colour = 'Type')
pca_rotation <- pca_result$rotation
pca_rotation[, 1:2]
## Plot using 1st and 2nd PCs
autoplot(pca_result, data = wine, colour = 'Type')
# list out
pca_rotation <- pca_result$rotation
pca_rotation[, 1:2]
# Set data up and train it
set.seed(1)
train_idx <- sample(1:nrow(wine), 0.7 * nrow(wine))
train_data <- wine[train_idx, -1]
test_data <- wine[-train_idx, -1]
train_labels <- wine$Type[train_idx]
test_labels <- wine$Type[-train_indx]
test_labels <- wine$Type[-train_idx]
knn_pred <- knn(train_data, test_data, train_labels, k = 3)
mean(knn_pred == test_labels)
# Display Model
table(knn_pred, test_labels)
# Accuracy
mean(knn_pred == test_labels)
pca_scores <- pca_result$x[, 1:2]
train_pca <- pca_scores[train_idx, ]
test_pca <- pca_scores[-train_idx, ]
knn_pca_pred <- knn(train_pca, test_pca, train_labels, k = 3)
mean(knn_pca_pred == test_labels)
table(knn_pca_pred, test_labels)
mean(knn_pca_pred == test_labels)
## Contingency tables
cat("Original variables model:\n")
table(knn_pred, test_labels)
cat("\nPCA model (first 2 PCs):\n")
table(knn_pca_pred, test_labels)
## Precision/Recall/F1 function
metrics <- function(pred, actual) {
tbl <- table(pred, actual)
precision <- diag(tbl) / rowSums(tbl)
recall <- diag(tbl) / colSums(tbl)
f1 <- 2 * precision * recall / (precision + recall)
data.frame(Precision = precision, Recall = recall, F1 = f1)
}
cat("\nOriginal variables metrics:\n")
metrics(knn_pred, test_labels)
cat("\nPCA model metrics:\n")
metrics(knn_pca_pred, test_labels)
print("Original variables metrics:")
metrics(knn_pred, test_labels)
print("PCA model metrics:")
metrics(knn_pca_pred, test_labels)
# Original variables metrics:
metrics(knn_pred, test_labels)
# PCA model metrics:
metrics(knn_pca_pred, test_labels)
# Original variables model
table(knn_pred, test_labels)
# PCA model (first 2 PCs)
table(knn_pca_pred, test_labels)
## Precision/Recall/F1 function
metrics <- function(pred, actual) {
tbl <- table(pred, actual)
precision <- diag(tbl) / rowSums(tbl)
recall <- diag(tbl) / colSums(tbl)
f1 <- 2 * precision * recall / (precision + recall)
data.frame(Precision = precision, Recall = recall, F1 = f1)
}
# Original variables metrics
metrics(knn_pred, test_labels)
# PCA model metrics
metrics(knn_pca_pred, test_labels)
# Original variables model
table(knn_pred, test_labels)
# PCA model (first 2 PCs)
table(knn_pca_pred, test_labels)
metrics <- function(pred, actual) {
tbl <- table(pred, actual)
precision <- diag(tbl) / rowSums(tbl)
recall <- diag(tbl) / colSums(tbl)
f1 <- 2 * precision * recall / (precision + recall)
data.frame(Precision = precision, Recall = recall, F1 = f1)
}
# Original variables metrics
metrics(knn_pred, test_labels)
# PCA model metrics
metrics(knn_pca_pred, test_labels)
## read dataset
wine <- read_csv("wine.data", col_names = FALSE)
## set column names
names(wine) <- c("Type","Alcohol","Malic acid","Ash","Alcalinity of ash","Magnesium","Total phenols","Flavanoids","Nonflavanoid Phenols","Proanthocyanins","Color Intensity","Hue","Od280/od315 of diluted wines","Proline")
## inspect data frame
head(wine)
wine$Type <- as.factor(wine$Type)
## visualize variables
pairs.panels(wine[,-1],gap = 0,bg = c("red", "yellow", "blue")[wine$Type],pch=21)
ggpairs(wine, ggplot2::aes(colour = Type))
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Plot using 1st and 2nd PCs
autoplot(pca_result, data = wine, colour = 'Type')
# list out
pca_rotation <- pca_result$rotation
pca_rotation[, 1:2]
# Set data up and train it
set.seed(1)
# Set data up and train it
set.seed(1)
train_idx <- sample(1:nrow(wine), 0.7 * nrow(wine))
train_data <- wine[train_idx, -1]
test_data <- wine[-train_idx, -1]
train_labels <- wine$Type[train_idx]
test_labels <- wine$Type[-train_idx]
knn_pred <- knn(train_data, test_data, train_labels, k = 3)
pca_scores <- pca_result$x[, 1:2]
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Compute PCA (excluding the Type column)
pca_result <- prcomp(wine[,-1], scale. = TRUE)
## Plot using 1st and 2nd PCs
autoplot(pca_result, data = wine, colour = 'Type')
# list out
pca_rotation <- pca_result$rotation
pca_rotation[, 1:2]
# Original variables model
table(knn_pred, test_labels)
# PCA model (first 2 PCs)
table(knn_pca_pred, test_labels)
# Original variables model
table(knn_pred, test_labels)
# PCA model
table(knn_pca_pred, test_labels)
metrics <- function(pred, actual) {
tbl <- table(pred, actual)
precision <- diag(tbl) / rowSums(tbl)
recall <- diag(tbl) / colSums(tbl)
f1 <- 2 * precision * recall / (precision + recall)
data.frame(Precision = precision, Recall = recall, F1 = f1)
}
# Original variables metrics
metrics(knn_pred, test_labels)
# PCA model metrics
metrics(knn_pca_pred, test_labels)
